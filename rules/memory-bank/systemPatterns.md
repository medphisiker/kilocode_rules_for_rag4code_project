# System Patterns

## Архитектурные принципы
- **Domain-Driven Design (DDD)**: Бизнес-логика (Core) полностью отделена от интерфейсов (MCP, Web, CLI).
- **LEGO-принцип**: Каждый компонент (DB, Embedder, Chunker) является заменяемым модулем с четким интерфейсом.
- **Thin MCP Layer**: MCP-сервер является лишь тонким адаптером над Backend Engine.

## Ключевые паттерны
- **Dependency Injection**: Использование интерфейсов для возможности легкой замены компонентов (например, замена Qdrant на другую векторную БД).
- **Modular Chunker**: Выделение логики разбиения текста в отдельный пакет.
- **Unified Engine API**: Единая точка входа для всех интерфейсов доступа.

## Структура проекта
- `src/rag4code/core/` — Сердце системы (бизнес-логика, `RagEngine`).
- `src/rag4code/interfaces/` — Абстрактные интерфейсы для плагинов.
- `packages/` — Реализации плагинов (Chunkers, VectorDB adapters).
- `hsm/` — Инструмент оркестрации стека.

## Механизм расширения
- **Entry Points**: Плагины регистрируются через стандартный механизм Python Entry Points.
- **PluginFactory**: Универсальная фабрика для загрузки и инстанцирования плагинов по имени.